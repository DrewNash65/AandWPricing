<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator - 1-to-1 Aesthetics & Wellness</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="danville-branding.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        .color-preview {
            margin-top: 0.75rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .preview-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .color-swatch-container {
            display: flex;
            gap: 0.5rem;
        }

        .color-swatch {
            width: 2rem;
            height: 2rem;
            border-radius: 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .color-swatch.secondary {
            width: 1.5rem;
            height: 1.5rem;
            margin-top: 0.25rem;
        }

        #colorDescription {
            color: #dbeafe;
            font-size: 0.9rem;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="danville-container">
        <header class="danville-header">
            <div style="text-align: center; margin-bottom: 2rem;">
                <img src="/images/1to1-logo.png" alt="1-to-1 Aesthetics & Wellness" class="danville-logo">
                <h1>1-to-1 Aesthetics & Wellness</h1>
                <p class="tagline">QR Code Generator</p>
            </div>
        </header>

        <main class="main-content">
            <div class="qr-generator-section">
                <div class="welcome-banner">
                    <h2>Generate QR Code for Your Pricing Portal</h2>
                    <p>Create a QR code that links directly to your pricing website</p>
                </div>

                <div class="generator-form">
                    <div class="form-group">
                        <label for="websiteUrl">Website URL:</label>
                        <input type="url" id="websiteUrl" placeholder="https://yourwebsite.com" value="">
                        <p class="help-text">Enter the full URL where your pricing portal is hosted</p>
                    </div>

                    <div class="form-group">
                        <label for="qrSize">QR Code Size:</label>
                        <select id="qrSize">
                            <option value="200">Small (200x200)</option>
                            <option value="300" selected>Medium (300x300)</option>
                            <option value="400">Large (400x400)</option>
                            <option value="500">Extra Large (500x500)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="colorTheme">Color Theme:</label>
                        <select id="colorTheme" onchange="updateColorPreview()">
                            <option value="danville" selected>Danville - Muted Teal/Green</option>
                            <option value="pennvalley">Penn Valley - Purple/Light Blue</option>
                        </select>
                        <p class="help-text">Choose the color scheme that matches your location branding</p>

                        <!-- Color Preview -->
                        <div class="color-preview" id="colorPreview">
                            <div class="preview-item">
                                <div class="color-swatch-container" id="colorSwatchContainer">
                                    <div class="color-swatch primary" id="colorSwatch" style="background-color: #0f766e;"></div>
                                    <div class="color-swatch secondary" id="backgroundSwatch" style="background-color: #ffffff; display: none;"></div>
                                </div>
                                <span id="colorDescription">Professional muted teal - matches 1to1WellnessMD.com</span>
                            </div>
                        </div>
                    </div>

                    <button onclick="generateQR()" class="danville-btn-primary">
                        Generate QR Code
                    </button>
                </div>

                <div class="qr-result" id="qrResult" style="display: none;">
                    <h3>Your QR Code</h3>
                    <div class="qr-display">
                        <canvas id="qrCanvas"></canvas>
                    </div>
                    <div class="qr-actions">
                        <button onclick="downloadQR()" class="danville-btn-secondary">
                            üì• Download QR Code
                        </button>
                        <button onclick="printQR()" class="danville-btn-secondary">
                            üñ®Ô∏è Print QR Code
                        </button>
                        <button onclick="openQRInNewTab()" class="danville-btn-secondary">
                            üîó Open in New Tab
                        </button>
                    </div>
                    <div class="qr-instructions">
                        <h4>How to Use Your QR Code:</h4>
                        <ul>
                            <li>Print the QR code and display it in your office</li>
                            <li>Add it to business cards or marketing materials</li>
                            <li>Include it in social media posts</li>
                            <li>Patients can scan with their phone camera to access pricing</li>
                        </ul>
                    </div>
                </div>

                <div class="usage-examples">
                    <h3>QR Code Usage Ideas</h3>
                    <div class="examples-grid">
                        <div class="example-item">
                            <div class="example-icon">üè¢</div>
                            <h4>Office Display</h4>
                            <p>Place QR codes in waiting areas for easy access to pricing information</p>
                        </div>
                        <div class="example-item">
                            <div class="example-icon">üí≥</div>
                            <h4>Business Cards</h4>
                            <p>Add QR codes to business cards for instant pricing access</p>
                        </div>
                        <div class="example-item">
                            <div class="example-icon">üì±</div>
                            <h4>Social Media</h4>
                            <p>Share QR codes on Instagram, Facebook, and other platforms</p>
                        </div>
                        <div class="example-item">
                            <div class="example-icon">üìß</div>
                            <h4>Email Signatures</h4>
                            <p>Include QR codes in email signatures for easy sharing</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="danville-footer">
            <div class="danville-container" style="text-align: center;">
                <img src="/images/1to1-logo.png" alt="1-to-1 Aesthetics & Wellness" class="danville-logo" style="margin-bottom: 1rem;">
                <p>&copy; 2024 1-to-1 Aesthetics & Wellness. All rights reserved.</p>
                <div class="contact-info">
                    <p>QR Code Generator for Pricing Portal</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Set default URL to current domain
        document.addEventListener('DOMContentLoaded', function() {
            const urlInput = document.getElementById('websiteUrl');
            urlInput.value = window.location.origin + '/index.html';
            updateColorPreview(); // Initialize color preview
        });

        function updateColorPreview() {
            const colorTheme = document.getElementById('colorTheme').value;
            const colorSwatch = document.getElementById('colorSwatch');
            const backgroundSwatch = document.getElementById('backgroundSwatch');
            const colorDescription = document.getElementById('colorDescription');

            const themes = {
                danville: {
                    color: '#0f766e',
                    background: '#ffffff',
                    description: 'Professional muted teal - matches 1to1WellnessMD.com',
                    showBackground: false
                },
                pennvalley: {
                    color: '#7c3aed',
                    background: '#dbeafe',
                    description: 'Purple QR code with light blue background - modern branding',
                    showBackground: true
                }
            };

            const theme = themes[colorTheme];
            colorSwatch.style.backgroundColor = theme.color;
            backgroundSwatch.style.backgroundColor = theme.background;
            backgroundSwatch.style.display = theme.showBackground ? 'block' : 'none';
            colorDescription.textContent = theme.description;
        }

        function generateQR() {
            const url = document.getElementById('websiteUrl').value;
            const size = parseInt(document.getElementById('qrSize').value);
            const colorTheme = document.getElementById('colorTheme').value;
            const canvas = document.getElementById('qrCanvas');

            if (!url) {
                alert('Please enter a website URL');
                return;
            }

            // Define color schemes
            const colorSchemes = {
                danville: {
                    dark: '#0f766e',    // Teal-700 - muted teal
                    light: '#ffffff',   // White background
                    border: '#0f766e'   // Matching border
                },
                pennvalley: {
                    dark: '#7c3aed',    // Purple-600 - vibrant purple
                    light: '#dbeafe',   // Light blue background (blue-100)
                    border: '#7c3aed'   // Purple border
                }
            };

            const colors = colorSchemes[colorTheme];

            // Try using the QRCode library first
            if (typeof QRCode !== 'undefined') {
                // Generate QR code using library
                QRCode.toCanvas(canvas, url, {
                    width: size,
                    height: size,
                    margin: 2,
                    color: {
                        dark: colors.dark,
                        light: colors.light
                    }
                }, function (error) {
                    if (error) {
                        console.error(error);
                        generateQRFallback(url, size, colorTheme);
                    } else {
                        document.getElementById('qrResult').style.display = 'block';
                        document.getElementById('qrResult').scrollIntoView({ behavior: 'smooth' });
                    }
                });
            } else {
                // Fallback to API method
                generateQRFallback(url, size, colorTheme);
            }
        }

        function generateQRFallback(url, size, colorTheme = 'danville') {
            // Define color schemes for API
            const colorSchemes = {
                danville: {
                    color: '0f766e',    // Teal-700 (remove # for API)
                    bgcolor: 'ffffff',  // White background
                    border: '#0f766e'   // CSS border color
                },
                pennvalley: {
                    color: '7c3aed',    // Purple-600 (remove # for API)
                    bgcolor: 'dbeafe',  // Light blue background (blue-100, remove # for API)
                    border: '#7c3aed'   // Purple border color
                }
            };

            const colors = colorSchemes[colorTheme];

            // Use QR Server API as fallback
            const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(url)}&color=${colors.color}&bgcolor=${colors.bgcolor}`;

            // Create an image element instead of canvas
            const qrDisplay = document.querySelector('.qr-display');
            qrDisplay.innerHTML = `
                <img src="${qrApiUrl}" alt="QR Code"
                     style="border: 2px solid ${colors.border}; border-radius: 10px; cursor: pointer;"
                     title="Right-click to save image"
                     oncontextmenu="return true;">
                <p style="font-size: 0.9rem; color: #64748b; margin-top: 10px;">
                    üí° Tip: Right-click the QR code above and select "Save Image As" to download
                </p>
            `;

            // Store the QR URL for download
            window.currentQRUrl = qrApiUrl;

            document.getElementById('qrResult').style.display = 'block';
            document.getElementById('qrResult').scrollIntoView({ behavior: 'smooth' });
        }

        function openQRInNewTab() {
            if (window.currentQRUrl) {
                window.open(window.currentQRUrl, '_blank');
            } else {
                alert('Please generate a QR code first');
            }
        }

        function downloadQR() {
            const canvas = document.getElementById('qrCanvas');

            if (canvas && canvas.toDataURL && canvas.width > 0) {
                // Canvas method
                const link = document.createElement('a');
                link.download = '1to1-aesthetics-qr-code.png';
                link.href = canvas.toDataURL();
                link.click();
            } else if (window.currentQRUrl) {
                // API method - fetch and download the image
                fetch(window.currentQRUrl)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.download = '1to1-aesthetics-qr-code.png';
                        link.href = url;
                        link.click();
                        window.URL.revokeObjectURL(url);
                    })
                    .catch(error => {
                        console.error('Download failed:', error);
                        // Fallback: open in new tab
                        window.open(window.currentQRUrl, '_blank');
                        alert('Download failed. QR code opened in new tab - right-click to save.');
                    });
            } else {
                alert('Please generate a QR code first');
            }
        }

        function printQR() {
            const canvas = document.getElementById('qrCanvas');
            let qrImageSrc = '';

            if (canvas && canvas.toDataURL && canvas.width > 0) {
                qrImageSrc = canvas.toDataURL();
            } else if (window.currentQRUrl) {
                qrImageSrc = window.currentQRUrl;
            } else {
                alert('Please generate a QR code first');
                return;
            }

            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>1-to-1 Aesthetics & Wellness - QR Code</title>
                        <style>
                            body {
                                font-family: Arial, sans-serif;
                                text-align: center;
                                padding: 20px;
                            }
                            .qr-container {
                                margin: 20px auto;
                                max-width: 400px;
                            }
                            h1 {
                                color: #1e40af;
                                margin-bottom: 10px;
                            }
                            p {
                                color: #666;
                                margin-bottom: 20px;
                            }
                            img {
                                border: 2px solid #1e40af;
                                border-radius: 10px;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="qr-container">
                            <h1>1-to-1 Aesthetics & Wellness</h1>
                            <p>Scan for Pricing Information</p>
                            <img src="${qrImageSrc}" alt="QR Code">
                            <p>Visit: ${document.getElementById('websiteUrl').value}</p>
                        </div>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
    </script>
</body>
</html>
